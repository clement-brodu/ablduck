Ext.data.JsonP.mip_connectionmanager({"files":[],"uses":["mip.collection.*","mip.*"],"id":"class-mip.connectionmanager","tagname":"class","name":"mip.connectionmanager","extends":"cls.mip","author":"","comment":"\u003ch2\u003ePurpose\u003c/h2\u003e\n\u003cp\u003eThe connection manager is used to keep track of connections to external MIP sytems,\u003cbr /\u003e\nnamely one client and distributed systems at this point.\u003c/p\u003e\n\u003ch4\u003eExamples\u003c/h4\u003e\n\u003ch4\u003egetPassword for currently logged in user\u003c/h4\u003e\n\u003cpre\u003e\u003ccode\u003e mip.connectionmanager:getPassword().\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch4\u003egetPassword\u003c/h4\u003e\n\u003cpre\u003e\u003ccode\u003e mip.connectionmanager:getPassword(\u0026quot;UserCode\u0026quot;:U).\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch4\u003egetServerDetails for current session\u003c/h4\u003e\n\u003cpre\u003e\u003ccode\u003e DEFINE VARIABLE hServer         AS HANDLE    NO-UNDO.\n DEFINE VARIABLE cSessionDetails AS CHARACTER NO-UNDO.\n hServer \u003d mip.connectionmanager:getServerDetails\n                                    (\u0026quot;\u0026quot;:U,\n                                     cSessionDetails).\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch4\u003egetServerDetails\u003c/h4\u003e\n\u003cpre\u003e\u003ccode\u003e DEFINE VARIABLE hServer         AS HANDLE    NO-UNDO.\n DEFINE VARIABLE cSessionDetails AS CHARACTER NO-UNDO.\n hServer \u003d mip.connectionmanager:getServerDetails\n                                    (\u0026quot;ExternalSystemCode\u0026quot;:U,\n                                     cSessionDetails).\n\u003c/code\u003e\u003c/pre\u003e\n","icon":"class","superclasses":["cls.mip","mip.connectionmanager"],"subclasses":[],"implements":[],"members":[{"id":"method-getPassword","name":"getPassword","owner":"mip.connectionmanager","tagname":"method","comment":"\u003cp\u003eReturns the encrypted password for the user that is currently logged in.\u003c/p\u003e\n","returns":{"datatype":"CHARACTER","comment":"The users encrypted password."},"meta":{}},{"id":"method-getPassword-1","name":"getPassword","owner":"mip.connectionmanager","tagname":"method","comment":"\u003cp\u003eReturns the encrypted password for the user code passed into the method.\u003c/p\u003e\n","parameters":[{"name":"ipcUserCode","datatype":"CHARACTER","mode":"INPUT","comment":"\u003cp\u003eUser code for the user you wish to retrieve the encrypted password for.\u003c/p\u003e\n"}],"returns":{"datatype":"CHARACTER","comment":"The users encrypted password."},"meta":{}},{"id":"method-getServerDetails","name":"getServerDetails","owner":"mip.connectionmanager","tagname":"method","comment":"\u003cp\u003eConnects to the external system. If neither the ipdSystemObj or the ipcSystemCode\u003cbr /\u003e\nare provided the method with return you the handle of the system you are currently\u003cbr /\u003e\nrunning on.\u003c/p\u003e\n","parameters":[{"name":"ipdSystemObj","datatype":"DECIMAL","mode":"INPUT","comment":"\u003cp\u003eExternal system obj to connect to.\u003c/p\u003e\n"},{"name":"ipcSystemCode","datatype":"CHARACTER","mode":"INPUT","comment":"\u003cp\u003eExternal system code to connect to.\u003c/p\u003e\n"}],"returns":{"datatype":"HANDLE","comment":"A handle to the external system."},"meta":{}},{"id":"method-getServerDetails-1","name":"getServerDetails","owner":"mip.connectionmanager","tagname":"method","comment":"\u003cp\u003eConnects to the external system. If the ipcSystemCode is not provided the\u003cbr /\u003e\nmethod with return you the handle and the session details for the system you are currently\u003cbr /\u003e\nlogged into.\u003c/p\u003e\n","parameters":[{"name":"ipcSystemCode","datatype":"CHARACTER","mode":"INPUT","comment":"\u003cpre\u003e\u003ccode\u003e External system code to connect to. \n\u003c/code\u003e\u003c/pre\u003e\n"},{"name":"opcSessionDetails","datatype":"CHARACTER","mode":"OUTPUT","comment":"\u003cp\u003eSession details for the external system\u003c/p\u003e\n"}],"returns":{"datatype":"HANDLE","comment":"A handle to the external system."},"meta":{}},{"id":"method-getServerDetails-2","name":"getServerDetails","owner":"mip.connectionmanager","tagname":"method","comment":"\u003cp\u003eConnects to the external system. If the ipcSystemCode is not provided the\u003cbr /\u003e\nmethod with return you the handle and the session details for the system you are currently\u003cbr /\u003e\nlogged into.\u003c/p\u003e\n","parameters":[{"name":"ipcSystemCode","datatype":"CHARACTER","mode":"INPUT","comment":"\u003cpre\u003e\u003ccode\u003e   External system code to connect to. \n\u003c/code\u003e\u003c/pre\u003e\n"},{"name":"oplWasAlternateUser","datatype":"LOGICAL","mode":"OUTPUT","comment":"\u003cp\u003eWas the alternate user stored on the external system record                              used to log in.\u003c/p\u003e\n"},{"name":"opcSessionDetails","datatype":"CHARACTER","mode":"OUTPUT","comment":"\u003cp\u003eSession details for the external system\u003c/p\u003e\n"}],"returns":{"datatype":"HANDLE","comment":"A handle to the external system."},"meta":{}},{"id":"method-getServerDetails-3","name":"getServerDetails","owner":"mip.connectionmanager","tagname":"method","comment":"\u003cp\u003eConnects to the external system. If the ipcSystemCode is not provided the\u003cbr /\u003e\nmethod with return you the handle and the session details for the system you are currently\u003cbr /\u003e\nlogged into.\nIn One Client environments we allow the user to have a view only window into the other external\u003cbr /\u003e\nsystem even if they don\u0027t have a user created in that system. This is catered for by\u003cbr /\u003e\nproviding an alternate user code and password for the connection manager to use\u003cbr /\u003e\nshould the current users details not work.\nIf these alternate details were used to log in, we will return you TRUE in the oplWasAlternateUser\u003cbr /\u003e\noutput parameter.\u003c/p\u003e\n","parameters":[{"name":"ipcSystemCode","datatype":"CHARACTER","mode":"INPUT","comment":"\u003cpre\u003e\u003ccode\u003e    External system code to connect to. \n\u003c/code\u003e\u003c/pre\u003e\n"},{"name":"ipcAlternateUserCode","datatype":"CHARACTER","mode":"INPUT","comment":"\u003cp\u003eAlternate login details for if the current users details don\u0027t work.\u003c/p\u003e\n"},{"name":"ipcAlternatePassword","datatype":"CHARACTER","mode":"INPUT","comment":"\u003cp\u003eAlternate login details for if the current users details don\u0027t work.\u003c/p\u003e\n"},{"name":"oplWasAlternateUser","datatype":"LOGICAL","mode":"OUTPUT","comment":"\u003cp\u003eWas the alternate user stored on the external system record                               used to log in.\u003c/p\u003e\n"},{"name":"opcSessionDetails","datatype":"CHARACTER","mode":"OUTPUT","comment":"\u003cpre\u003e\u003ccode\u003eSession details for the external system \n\u003c/code\u003e\u003c/pre\u003e\n"}],"returns":{"datatype":"HANDLE","comment":"A handle to the external system."},"meta":{}},{"id":"method-isConnected","name":"isConnected","owner":"mip.connectionmanager","tagname":"method","comment":"\u003cp\u003eCheck whether the server passed in is connected.\u003c/p\u003e\n","parameters":[{"name":"iphServer","datatype":"HANDLE","mode":"INPUT","comment":"\u003cp\u003eHandle to a server.\u003c/p\u003e\n"}],"returns":{"datatype":"LOGICAL","comment":"Returns TRUE if the server is currently connected."},"meta":{}},{"id":"method-loginToRemoteServers","name":"loginToRemoteServers","owner":"mip.connectionmanager","tagname":"method","comment":"\u003cp\u003eLogin in to remote external systems.\u003c/p\u003e\n","parameters":[{"name":"iplForceNewLogin","datatype":"LOGICAL","mode":"INPUT","comment":"\u003cp\u003eForce a new login into all grouped systems\u003c/p\u003e\n"}],"returns":{"comment":""},"meta":{}},{"id":"method-prepareSessionDetails","name":"prepareSessionDetails","owner":"mip.connectionmanager","tagname":"method","comment":"\u003cp\u003ePrepares the session details, which will get the currently logged in users session details\u003cbr /\u003e\nfrom his session context and copies them to the cached external system table.\u003c/p\u003e\n","returns":{"datatype":"LOGICAL","comment":"Returns TRUE if the method completes successfully."},"meta":{}},{"id":"method-rememberEncryptedCredentials","name":"rememberEncryptedCredentials","owner":"mip.connectionmanager","tagname":"method","comment":"\u003cp\u003eThis method takes in the users code and encrypted password and remembers them for future use.\u003c/p\u003e\n","parameters":[{"name":"ipcUserCode","datatype":"CHARACTER","mode":"INPUT","comment":"\u003cp\u003eUser code to remember.\u003c/p\u003e\n"},{"name":"ipcPassword","datatype":"CHARACTER","mode":"INPUT","comment":"\u003cp\u003eEncrypted password to remember.\u003c/p\u003e\n"}],"returns":{"datatype":"LOGICAL","comment":"Returns TRUE if the method completes successfully."},"meta":{"final":true}},{"id":"method-rememberCredentials","name":"rememberCredentials","owner":"mip.connectionmanager","tagname":"method","comment":"\u003cp\u003eThis method takes in the users code and password and remembers them for future use.\u003c/p\u003e\n","parameters":[{"name":"ipcUserCode","datatype":"CHARACTER","mode":"INPUT","comment":"\u003cp\u003eUser code to remember.\u003c/p\u003e\n"},{"name":"ipcPassword","datatype":"CHARACTER","mode":"INPUT","comment":"\u003cp\u003ePassword to remember.\u003c/p\u003e\n"}],"returns":{"datatype":"LOGICAL","comment":"Returns TRUE if the method completes successfully."},"meta":{"final":true}},{"id":"method-rememberSessionDetails","name":"rememberSessionDetails","owner":"mip.connectionmanager","tagname":"method","comment":"\u003cp\u003eSaves the users remote session details in their current session context to preserve the values\u003cbr /\u003e\nacross requests.\u003c/p\u003e\n","parameters":[{"name":"ipcSystemCode","datatype":"CHARACTER","mode":"INPUT","comment":"\u003cpre\u003e\u003ccode\u003e System code where these session details come from. \n\u003c/code\u003e\u003c/pre\u003e\n"},{"name":"ipcSessionDetails","datatype":"CHARACTER","mode":"INPUT","comment":"\u003cp\u003eSession details\u003c/p\u003e\n"}],"returns":{"datatype":"LOGICAL","comment":"Returns TRUE if the method completes successfully."},"meta":{}},{"id":"method-resetSessionDetails","name":"resetSessionDetails","owner":"mip.connectionmanager","tagname":"method","comment":"\u003cp\u003eClears the session details currently stored against the external system cache.\u003c/p\u003e\n","returns":{"datatype":"LOGICAL","comment":"Returns TRUE if the method completes successfully."},"meta":{}},{"id":"method-loginToRemoteServer","name":"loginToRemoteServer","owner":"mip.connectionmanager","tagname":"method","comment":"\u003cp\u003eLogs into a remote server\u003c/p\u003e\n","returns":{"comment":""},"meta":{"private":true}},{"id":"method-loginToRemoteServer-1","name":"loginToRemoteServer","owner":"mip.connectionmanager","tagname":"method","comment":"\u003cp\u003eLogs into a remote server using the supplied user code and password.\u003c/p\u003e\n","parameters":[{"name":"ipcUserCode","datatype":"CHARACTER","mode":"INPUT","comment":"\u003cp\u003eUser code to log in to external system with.\u003c/p\u003e\n"},{"name":"ipcPassword","datatype":"CHARACTER","mode":"INPUT","comment":"\u003cp\u003ePassword to log in to external system with.\u003c/p\u003e\n"}],"returns":{"comment":""},"meta":{"private":true}},{"id":"method-addToCacheList","name":"addToCacheList","owner":"mip.connectionmanager","tagname":"method","comment":"\u003cp\u003eAdds the system code to the cached list.\u003c/p\u003e\n","parameters":[{"name":"ipcLookupValue","datatype":"CHARACTER","mode":"INPUT","comment":""},{"name":"ipcSystemCode","datatype":"CHARACTER","mode":"INPUT","comment":""}],"returns":{"datatype":"LOGICAL","comment":"Returns TRUE if the system was cached successfully."},"meta":{"private":true}},{"id":"temptable-ttEsAppServer","name":"ttEsAppServer","owner":"mip.connectionmanager","tagname":"temptable","definition":"DEFINE TEMP-TABLE ttEsAppServer \n  FIELD dSystemObj AS DECIMAL\n  FIELD cSystemCode AS CHARACTER\n  FIELD cConnectionString AS CHARACTER\n  FIELD cSessionDetails AS CHARACTER\n  FIELD hServer AS HANDLE\n  INDEX idxSystemCode PRIMARY UNIQUE cSystemCode\n  INDEX idxSystemObj UNIQUE dSystemObj\n","comment":"","meta":{}},{"id":"temptable-ttCredentials","name":"ttCredentials","owner":"mip.connectionmanager","tagname":"temptable","definition":"DEFINE TEMP-TABLE ttCredentials \n  FIELD cUserCode AS CHARACTER\n  FIELD cPassword AS CHARACTER\n  INDEX idxUser PRIMARY UNIQUE cUserCode\n","comment":"","meta":{}},{"id":"property-mipEnv","name":"mipEnv","owner":"cls.mip","tagname":"property","datatype":"cls.mipenvironment","comment":"","meta":{}},{"id":"property-PrivateData","name":"PrivateData","owner":"cls.mip","tagname":"property","datatype":"CHARACTER","comment":"","meta":{}},{"id":"property-mipEnvStatic","name":"mipEnvStatic","owner":"cls.mip","tagname":"property","datatype":"cls.mipenvironment","comment":"","meta":{}}],"meta":{}});